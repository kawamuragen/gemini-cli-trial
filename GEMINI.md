# 株価分析アプリ - プロジェクトコンテキスト

このファイルは、Gemini CLIエージェントが本プロジェクトのコンテキストを理解し、効率的に作業を進めるためのガイドです。

## 1. プロジェクト概要

本プロジェクトは、Next.js (React, TypeScript) を使用して構築された米国株価分析アプリケーションです。ユーザーが銘柄コードを入力すると、Alpha Vantage APIから株価データを取得し、その銘柄の過去の株価データと25日移動平均線をグラフで表示します。

*   **目的**: 米国株のテクニカル分析グラフ（移動平均線を含む）の表示
*   **対象ユーザー**: 開発者本人（認証機能なし）
*   **対象市場**: 米国株
*   **プラットフォーム**: Webブラウザ (Next.jsアプリケーション)
*   **データソース**: Alpha Vantage API (無料枠利用)

## 2. ディレクトリ構造

```
/home/kawamuragen/projects/gemini-cli-trial/
├── GEMINI.md               # このファイル
├── requirements.md         # アプリケーションの要件定義と開発計画
└── client/                 # Next.jsフロントエンドアプリケーション
    ├── .env.local          # 環境変数 (Alpha Vantage APIキーなど)
    ├── package.json        # プロジェクトの依存関係とスクリプト
    ├── next.config.mjs     # Next.jsの設定ファイル
    ├── tailwind.config.ts  # Tailwind CSSの設定ファイル
    ├── tsconfig.json       # TypeScriptの設定ファイル
    └── src/
        ├── app/
        │   ├── api/
        │   │   └── stock/
        │   │       └── route.ts  # 株価データ取得APIルート (サーバーサイド)
        │   ├── globals.css       # グローバルCSS (Tailwind CSSのインポートなど)
        │   ├── layout.tsx        # ルートレイアウト (HTML, Bodyタグなど)
        │   └── page.tsx          # メインページコンポーネント (クライアントサイド)
        └── ... (その他のNext.js生成ファイル)
```

## 3. 使用技術スタック

*   **フレームワーク**: Next.js (v14.x, App Router, TypeScript)
*   **UIフレームワーク/スタイリング**: React, Tailwind CSS
*   **チャートライブラリ**: Recharts
*   **日付操作**: `date-fns`
*   **API**: Alpha Vantage (株価データ)
*   **パッケージマネージャー**: npm

## 4. 開発環境のセットアップと実行方法

### 前提条件
*   Node.js (v18.x 以降推奨)
*   npm

### セットアップ手順

1.  **プロジェクトルートに移動**:
    ```bash
    cd /home/kawamuragen/projects/gemini-cli-trial/
    ```

2.  **クライアントアプリケーションの依存関係をインストール**:
    ```bash
    cd client
    npm install
    ```

3.  **環境変数の設定**:
    `client/.env.local` ファイルを `client/` ディレクトリ直下に作成し、以下の内容を記述してください。`YOUR_ALPHA_VANTAGE_API_KEY` はご自身で取得したAlpha VantageのAPIキーに置き換えてください。
    ```
    ALPHA_VANTAGE_API_KEY=YOUR_ALPHA_VANTAGE_API_KEY
    ```
    APIキーは [Alpha Vantage 公式サイト](https://www.alphavantage.co/) で取得できます。

4.  **開発サーバーの起動**:
    ```bash
    cd client
    npm run dev
    ```
    開発サーバーは `http://localhost:3000` で起動します。ブラウザでアクセスしてアプリケーションを確認してください。

## 5. 主要なファイルとその役割

*   `requirements.md`: 本プロジェクトの初期要件定義と開発計画が記述されています。
*   `client/src/app/api/stock/route.ts`:
    *   Next.jsのAPIルートとして機能します。
    *   クライアントからの銘柄コードを受け取り、Alpha Vantage APIに株価データをリクエストします。
    *   取得したデータを整形し、クライアントにJSON形式で返します。
    *   APIキーは環境変数 `ALPHA_VANTAGE_API_KEY` から取得します。
*   `client/src/app/page.tsx`:
    *   アプリケーションのメインページコンポーネントです。
    *   銘柄コード入力フォームと、株価チャート（Rechartsを使用）を表示します。
    *   クライアントサイドでAPIルート (`/api/stock`) を呼び出し、株価データを取得します。
    *   取得したデータから25日移動平均線を計算し、チャートに描画します。
    *   `'use client'` ディレクティブにより、クライアントコンポーネントとして動作します。
*   `client/src/app/globals.css`:
    *   Tailwind CSSのインポートと、グローバルなスタイル定義が含まれています。
    *   `body`タグの基本的なスタイルはTailwind CSSのユーティリティクラスで制御されるように調整済みです。
*   `client/src/app/layout.tsx`:
    *   Next.jsのルートレイアウトファイルです。
    *   HTMLの `<html>` と `<body>` タグを定義し、アプリケーション全体に適用されるフォントやCSSをインポートします。

## 6. 重要なコマンド

プロジェクトの `client/` ディレクトリ内で実行します。

*   `npm run dev`: 開発サーバーを起動します。
*   `npm run build`: 本番環境用のアプリケーションをビルドします。
*   `npm run start`: ビルドされたアプリケーションを本番モードで起動します。
*   `npm run lint`: ESLintを実行し、コードの構文チェックとスタイルチェックを行います。

## 7. 既知の問題と考慮事項

*   **Alpha Vantage APIのリクエスト制限**: 無料APIは、1分あたり5リクエスト、1日あたり500リクエストの制限があります。短期間に多数のリクエストを行うと、API制限に達し、エラーが返される可能性があります。
*   **銘柄コードの存在確認**: 存在しない銘柄コードが入力された場合、APIからのエラーメッセージを捕捉し、「指定された銘柄コードが見つかりません。正しい銘柄コードを入力してください。」というユーザーフレンドリーなメッセージを表示するように実装済みです。
*   **サーバーサイドレンダリング (SSR)**: Next.jsのApp Routerの特性上、APIルートはサーバーサイドで実行され、`page.tsx`はクライアントコンポーネントとして動作します。データ取得はクライアントサイドで行われますが、API呼び出し自体はサーバーサイドのロジックを経由します。

## 8. エージェントへの指示

*   コード変更を行う際は、既存のNext.js (App Router) およびTypeScriptの慣習に従ってください。
*   Tailwind CSSのユーティリティクラスを積極的に利用し、カスタムCSSの記述は最小限に抑えてください。
*   新しいライブラリを導入する際は、まずその必要性を検討し、既存のプロジェクトの依存関係と競合しないか確認してください。
*   機能追加や修正の際は、関連するテスト（もしあれば）の更新も考慮してください。
*   不明な点があれば、必ずユーザーに確認してください。

## 9. 今後の要望に関するフロー

ユーザーからの要望は、以下のフローで処理します。

1.  **要望のヒアリングと理解**: ユーザー様からの要望を伺い、不明点があれば質問させていただきます。
2.  **要件定義の確認**: ユーザー様と認識の齟齬がないよう、要件を明確化します。
3.  **`requirements.md` の更新**: 確定した要件を `requirements.md` に追記し、プロジェクトの要件として記録します。
4.  **実装計画の提示**: 要件に基づいた実装計画を提示します。
5.  **実装と検証**: 計画に沿って実装を行い、動作確認を行います。